// Two-way data binding library.
// https://github.com/ahabra/data-bind
// Copyright 2020 (C) Abdul Habra

!function(){const e=e=>"checkbox"===e.type,t=e=>"radio"===e.type,n=e=>"select"===e.tagName.toLowerCase(),r=e=>"value"in e,o=e=>new Set(Array.isArray(e)?e:[e]);function i(e,t){const n=e.querySelectorAll(t);return 0===n.length&&console.warn(`No elements found matching selector ${t}`),[...n]}window.bind=function({obj:l,prop:c,sel:u,attr:a,root:f}){!function({prop:e,sel:t}){if("string"!=typeof e||0===e.length)throw"'prop' argument must be a String defining the name a property.";if("string"!=typeof t||0===t.length)throw"'sel' argument must be a String defining a selector."}({prop:c,sel:u});const s=(l=l||{}).hasOwnProperty(c)?l[c]:void 0;f=f||document;const d={get:()=>function(o,l,c){const u=i(o,l);if(0===u.length)return null;let a=u[0];if(c)return a.getAttribute(c);if(!r(a))return a.innerHTML;if(e(a))return u.filter(t=>e(t)&&t.checked).map(e=>"on"===e.value?e.name:e.value);if(n(a)){return[...a.querySelectorAll("option")].filter(e=>e.selected).map(e=>e.value)}t(a)&&(a=u.filter(t).find(e=>e.checked));return a.value}(f,u,a),set:l=>function(l,c,u,a){const f=i(l,c);if(0===f.length)return;const s=f[0];if(e(s)){const t=o(u);return void f.filter(e).forEach(e=>e.checked=t.has(e.value)||t.has(e.name))}if(n(s)){const e=o(u);return void s.querySelectorAll("option").forEach(t=>t.selected=e.has(t.value))}if(t(s))return void f.filter(t).forEach(e=>e.checked=e.value===u);f.forEach(e=>function(e,t,n){n?e.setAttribute(n,t):r(e)?e.value=t:e.innerHTML=t}(e,u,a))}(f,u,l,a),configurable:!0,enumerable:!0};return Object.defineProperty(l,c,d),void 0!==s&&(console.info(`Property '${c}' already exists in object. Will override previous definition but retain old value of ${s}.`),l[c]=s),l}}();