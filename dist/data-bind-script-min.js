// Two-way data binding library.
// https://github.com/ahabra/data-bind
// Copyright 2020 (C) Abdul Habra

!function(){const e=e=>"checkbox"===e.type,t=e=>"radio"===e.type,o=e=>"select"===e.tagName.toLowerCase(),r=e=>"value"in e,n=e=>new Set(Array.isArray(e)?e:[e]);function i(e,t){const o=e.querySelectorAll(t);return 0===o.length&&console.warn(`No elements found matching selector ${t}`),[...o]}window.bind=function({obj:u={},prop:l,sel:c,attr:a,root:f=document,getter:s,setter:p,onChange:d}){!function(e){if("string"!=typeof e||0===e.length)throw"'prop' argument must be a String defining the name a property."}(l),function(e,t){const o=e[t];void 0!==o&&(console.info(`Property '${t}' already exists in object. Will override previous definition but retain old value of ${o}.`),e[t]=o)}(u,l);const h={};return s||(s=()=>function({prop:n,root:u,sel:l,attr:c,objNotBound:a}){return l?function(n,u,l){const c=i(n,u);if(0===c.length)return null;let a=c[0];if(l)return a.getAttribute(l);if(!r(a))return a.innerHTML;if(e(a))return c.filter((t=>e(t)&&t.checked)).map((e=>"on"===e.value?e.name:e.value));if(o(a)){return[...a.querySelectorAll("option")].filter((e=>e.selected)).map((e=>e.value))}if(t(a)&&(a=c.filter(t).find((e=>e.checked)),!a))return;return a.value}(u,l,c):a[n]}({prop:l,sel:c,attr:a,root:f,objNotBound:h})),p||(p=(u,s)=>function({prop:u,value:l,root:c,sel:a,attr:f,objNotBound:s}){if(a)return void function(u,l,c,a){const f=i(u,l);if(0===f.length)return;const s=f[0];if(e(s)){const t=n(c);return void f.filter(e).forEach((e=>e.checked=t.has(e.value)||t.has(e.name)))}if(o(s)){const e=n(c);return void s.querySelectorAll("option").forEach((t=>t.selected=e.has(t.value)))}if(t(s))return void f.filter(t).forEach((e=>e.checked=e.value===c));f.forEach((e=>function(e,t,o){o?e.setAttribute(o,t):r(e)?e.value=t:e.innerHTML=t}(e,c,a)))}(c,a,l,f);s[u]=l}({prop:l,value:s,root:f,sel:c,attr:a,objNotBound:h})),function({obj:e,prop:t,getter:o,setter:r,onChange:n}){const i={get:()=>o(t),set:e=>{if(n){const r=o(t);r!==e&&n(r,e)}r(t,e)},configurable:!0,enumerable:!0};return Object.defineProperty(e,t,i),e}({obj:u,prop:l,getter:s,setter:p,onChange:d})}}();